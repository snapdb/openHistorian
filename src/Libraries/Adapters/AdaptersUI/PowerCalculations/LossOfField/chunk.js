"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[106],{93106:(e,t,a)=>{a.r(t),a.d(t,{default:()=>y});var l=a(6904),n=a(2580),r=a(54840);const i={PSet:{Value:-600,Description:"Define the threshold of P-set MW."},QSet:{Value:200,Description:"Define the threshold of Q-set MVar."},QAreaSet:{Value:500,Description:"Define the threshold of Q-area MVar-sec."},VoltageThreshold:{Value:475e3,Description:"Define the threshold of voltage, in volts."},AnalysisInterval:{Value:30,Description:"Define the interval between adjacent calculations. The default value is the frame-rate defined in the connection string for this Frequency Excursion."},LagTime:{Value:3,IsValid:e=>e>0,Description:"Defines the allowed past time deviation tolerance, in seconds (can be sub-second)."},LeadTime:{Value:1,IsValid:e=>e>0,Description:"Defines the allowed future time deviation tolerance, in seconds (can be sub-second)."},FramesPerSecond:{Value:30,IsValid:e=>e>0,Description:"Defines the number of frames per second expected by the adapter."},Currents:{Value:[],Description:"Defines the Current Magnitude to be used.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")},Voltages:{Value:[],Description:"Defines the Voltage Magnitude to be used. If not supplied the system will use Primary or Secondary Voltage associated with the Current Phasor.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")},WarningSignal:{Value:"",Description:"Defines the Output Measurement for Warning Signal.",IsValid:e=>null!=e&&0!==e.trim().length},RealPower:{Value:"",Description:"Defines the Output Measurement for Real Power.",IsValid:e=>null!=e&&0!==e.trim().length},ReactivePower:{Value:"",Description:"Defines the Output Measurement for Reactive Power.",IsValid:e=>null!=e&&0!==e.trim().length},QAreaValue:{Value:"",Description:"Defines the Output Measurement for Q Area Value.",IsValid:e=>null!=e&&0!==e.trim().length}},s=["WarningSignal","RealPower","ReactivePower","QAreaValue"],o={WarningSignal:"Warning Signal",RealPower:"Real Power",ReactivePower:"Reactive Power",QAreaValue:"Q Area Value"},c=(e,t,a)=>new r.GrafanaQueryFunctions(`${t}api/Grafana`).Search({dataTypeIndex:r.Grafana.DataTypeIndex.Phasor,expression:`SELECT MagnitudePointTag, AnglePointTag FROM PhasorValues WHERE MagnitudePointTag LIKE '%${e}%' OR AnglePointTag LIKE '%${e}%' AND Type = '${a?"I":"V"}'`}).then((e=>{const t=[];return e.forEach((e=>{const[a,l]=e.split(",");t.push({Label:a,Value:a}),t.push({Label:l,Value:l})})),t}));var u=a(32098),d=a.n(u),m=a(55476),g=a(24334),p=a(28188),h=a(94194);const S="MM/DD/YYYY HH:mm:ss.SSS",f={Currents:{Value:[],Description:"Defines the Current Magnitude to be used.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")},Voltages:{Value:[],Description:"Defines the Voltage Magnitude to be used. If not supplied the system will use Primary or Secondary Voltage associated with the Current Phasor.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")}},v=e=>[{refID:"A",target:`Filter PhasorValues Where ${e.map((e=>`(AnglePointTag = '${e}' OR MagnitudePointTag = '${e}')`)).join(" OR ")}`,metadataSelections:[]}],y={Settings:e=>{var t,a,u,d,m,g;const p=l.useMemo((()=>r.AdapterHelperFuncs.parseConnectionString(e.ConnectionString,i)),[e.ConnectionString]);r.AdapterHelperFuncs.useSetInitialConnectionString(e.ConnectionString,e.SetConnectionString,i,p),r.AdapterHelperFuncs.useSetDefaultSettings(i,e.SetDefaultSettings);const[h,S]=l.useState(!0),f=l.useCallback((t=>{const a=r.AdapterHelperFuncs.constructConnectionString(t,i);e.SetConnectionString(a)}),[e.ConnectionString]),v=l.useCallback(((e,t)=>{const a=Object.assign(Object.assign({},p),{[t]:e});f(a)}),[p,f]),y=l.useCallback((e=>{f(Object.assign(Object.assign({},p),{Currents:[e]}))}),[p,f]),V=l.useCallback((e=>{f(Object.assign(Object.assign({},p),{Voltages:[e]}))}),[p,f]),E=l.useCallback((e=>{S(e.AutoMapVoltages),e.AutoMapVoltages&&f(Object.assign(Object.assign({},p),{Voltages:[]}))}),[p,f]);return l.useEffect((()=>{if(null==p)return;const t=[];1===p.Voltages.length||h||t.push("At least 1 Voltage input is required."),1!==p.Currents.length&&t.push("At least 1 Current input is required."),i.WarningSignal.IsValid(p.WarningSignal)||t.push("Warning Signal Output Measurement can not be empty."),i.RealPower.IsValid(p.RealPower)||t.push("RealPower Output Measurement can not be empty."),i.ReactivePower.IsValid(p.ReactivePower)||t.push("Reactive Power Output Measurement can not be empty."),i.QAreaValue.IsValid(p.QAreaValue)||t.push("Q Area Value Output Measurement can not be empty."),i.LagTime.IsValid(p.LagTime)||t.push("Lag Time must be greater than 0."),i.LeadTime.IsValid(p.LeadTime)||t.push("Lead Time must be greater than 0."),i.FramesPerSecond.IsValid(p.FramesPerSecond)||t.push("Frames Per Second must be greater than 0."),e.SetErrors(t)}),[p,h]),null==p?l.createElement(l.Fragment,null):l.createElement("div",{className:"container-fluid d-flex flex-column h-100 p-0"},l.createElement("div",{className:"row"},l.createElement("div",{className:"col-12"},l.createElement("fieldset",{className:"border",style:{padding:"10px"}},l.createElement("legend",{className:"w-auto pr-2",style:{fontSize:"large"}},"Phase Pair(s)"),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-12"},l.createElement(n.ToggleSwitch,{Record:{AutoMapVoltages:h},Field:"AutoMapVoltages",Setter:E,Label:"Auto Map Voltages",Help:"Flag to enable system to use Primary or Secondary Voltage associated of the Current Phasor."}))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-6"},l.createElement(n.SearchableSelect,{Record:{Value:null!==(a=null===(t=p.Currents)||void 0===t?void 0:t[0])&&void 0!==a?a:""},Field:"Value",Label:"Current Input",Setter:e=>y(e.Value),AllowCustom:!1,Search:t=>c(t,e.HomePath,!0),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})),l.createElement("div",{className:"col-6"},l.createElement(n.SearchableSelect,{Record:{Value:null!==(d=null===(u=p.Voltages)||void 0===u?void 0:u[0])&&void 0!==d?d:""},Field:"Value",Label:"Voltage Input",Setter:e=>V(e.Value),AllowCustom:!1,Search:t=>c(t,e.HomePath,!1),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:h||0===(null!==(g=null===(m=p.Currents)||void 0===m?void 0:m.length)&&void 0!==g?g:0)})))))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-12"},l.createElement("fieldset",{className:"border",style:{padding:"10px"}},l.createElement("legend",{className:"w-auto pr-2",style:{fontSize:"large"}},"Outputs"),s.map((t=>{const a=p[t];return l.createElement("div",{className:"row mb-2 align-items-center",key:t},l.createElement("div",{className:"col-12"},l.createElement(n.SearchableSelect,{Record:{Measurement:a},Field:"Measurement",Label:o[t],Setter:e=>v(e.Measurement,t),AllowCustom:!1,Search:t=>(0,r.handleMeasurementSearch)(t,`${e.HomePath}api/grafana`),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})))}))))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-12"},l.createElement(n.Input,{Record:p,Setter:f,Label:"Analysis Interval",Type:"number",Field:"AnalysisInterval",Valid:()=>!0,Help:i.AnalysisInterval.Description,AllowNull:!0}))),l.createElement("div",{className:"row"},l.createElement("div",{className:"col-12 col-xl-4"},l.createElement(n.Input,{Record:p,Setter:f,Label:"Frames Per Second",Type:"number",Field:"FramesPerSecond",Valid:e=>{var t,a,l;return null===(l=null===(a=null===(t=null==i?void 0:i.FramesPerSecond)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,p[e]))||void 0===l||l},Feedback:"Frames Per Second must be greater than 0.",Help:i.FramesPerSecond.Description,AllowNull:!0})),l.createElement("div",{className:"col-12 col-xl-4"},l.createElement(n.Input,{Record:p,Setter:f,Label:"Lag Time",Type:"number",Field:"LagTime",Valid:e=>{var t,a,l;return null===(l=null===(a=null===(t=i.LagTime)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,p[e]))||void 0===l||l},Feedback:"Lag Time must be greater than 0.",Help:i.LagTime.Description,AllowNull:!0})),l.createElement("div",{className:"col-12 col-xl-4"},l.createElement(n.Input,{Record:p,Setter:f,Label:"Lead Time",Type:"number",Field:"LeadTime",Valid:e=>{var t,a,l;return null===(l=null===(a=null===(t=i.LeadTime)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,p[e]))||void 0===l||l},Feedback:"Lead Time must be greater than 0.",Help:i.LeadTime.Description,AllowNull:!0}))))},Input:e=>{const t=`${e.HomePath}api/grafana`,a=l.useRef(null),{width:n}=(0,g.useGetContainerPosition)(a),i=(0,r.useGetLegendWidth)(n),{Currents:s,Voltages:o}=l.useMemo((()=>r.AdapterHelperFuncs.parseConnectionString(e.ConnectionString,f)),[e.ConnectionString]),[c,u]=l.useState({start:d().utc().subtract(e.Settings.DefaultDuration,"seconds").format(S).toString(),end:d().utc().format(S).toString()}),y=l.useMemo((()=>v(null!=s?s:[])),[s]),V=l.useMemo((()=>v(null!=o?o:[])),[o]),{Data:E,Status:b}=(0,r.useGrafanaQuery)(y,d().utc(c.start).toISOString(),d().utc(c.end).toISOString(),t,r.Grafana.DataTypeIndex.Phasor),{Data:w,Status:C}=(0,r.useGrafanaQuery)(V,d().utc(c.start).toISOString(),d().utc(c.end).toISOString(),t,r.Grafana.DataTypeIndex.Phasor),[P,D]=l.useState(0);return l.useEffect((()=>{const e=[...w,...E],t=setInterval((()=>{D((t=>{if(0===e.length||0===e[0].datapoints.length)return t;const a=Math.min(...e.map((e=>e.datapoints.length)));return 0===a?0:(t+1)%a}))}),5e3);return()=>clearInterval(t)}),[w,E]),l.createElement(l.Fragment,null,l.createElement("div",{className:"container-fluid d-flex flex-column h-100 p-0"},l.createElement("div",{className:"row m-0 pb-3"},l.createElement("div",{className:"col-12 p-0"},l.createElement(m.TimeFilter,{filter:c,setFilter:(e,t)=>u({start:e,end:t}),showQuickSelect:!0,isHorizontal:!0,dateTimeSetting:e.Settings.DateTimeSetting,timeZone:"UTC",format:"datetime-local",accuracy:"millisecond",showHelpMessage:!1}))),"loading"===b||"loading"===C?l.createElement("div",{className:"row m-0"},l.createElement("div",{className:"col-12 p-0 d-flex flex-column align-items-center justify-content-center"},l.createElement(h.ReactIcons.SpiningIcon,{Size:200}))):l.createElement(l.Fragment,null,l.createElement("div",{className:"row m-0"},l.createElement("div",{className:"col-9 p-0",ref:a},l.createElement(p.Kl,{defaultTdomain:[d().utc(c.start,S).valueOf(),d().utc(c.end,S).valueOf()],height:200,width:n,Ylabel:"Voltage (Mag)",legend:"right",yDomain:"AutoValue",Tlabel:"Time",useMetricFactors:!1,legendWidth:i,showDateOnTimeAxis:!0},w.map(((e,t)=>l.createElement(p.N1,{key:t,data:e.datapoints.map((e=>[e[2],e[0]])),color:(0,r.getColor)(t),lineStyle:"-",legend:e.target}))))),l.createElement("div",{className:"col-3 p-0 d-flex justify-content-center align-items-center"},l.createElement("svg",{width:"140",height:"140",viewBox:"0 0 140 140",style:{display:"block",marginTop:"8px"}},l.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:65}),l.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:35}),l.createElement("line",{style:{stroke:"currentColor"},x1:70,y1:0,x2:70,y2:140}),l.createElement("line",{style:{stroke:"currentColor"},x1:0,y1:70,x2:140,y2:70}),l.createElement("g",null,w.map(((e,t)=>0!==e.datapoints.length&&l.createElement("path",{key:t,style:{fill:(0,r.getColor)(t),stroke:(0,r.getColor)(t)},d:"M 70 70 L 70 0 L 65 10 L 75 10 L 70 0",transform:`rotate(${e.datapoints[0][1]} 70 70)`}))))))),l.createElement("div",{className:"row m-0"},l.createElement("div",{className:"col-9 p-0"},l.createElement(p.Kl,{defaultTdomain:[d().utc(c.start,S).valueOf(),d().utc(c.end,S).valueOf()],height:250,width:n,Ylabel:"Current (Mag)",legend:"right",yDomain:"AutoValue",Tlabel:"Time",useMetricFactors:!1,legendWidth:i,showDateOnTimeAxis:!0},E.map(((e,t)=>l.createElement(p.N1,{key:t,data:e.datapoints.map((e=>[e[2],e[0]])),color:(0,r.getColor)(t),lineStyle:"-",legend:e.target}))))),l.createElement("div",{className:"col-3 p-0 d-flex justify-content-center align-items-center"},l.createElement("svg",{width:"140",height:"140",viewBox:"0 0 140 140",style:{display:"block",marginTop:"8px"}},l.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:65}),l.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:35}),l.createElement("line",{style:{stroke:"currentColor"},x1:70,y1:0,x2:70,y2:140}),l.createElement("line",{style:{stroke:"currentColor"},x1:0,y1:70,x2:140,y2:70}),l.createElement("g",null,E.map(((e,t)=>0!==e.datapoints.length&&l.createElement("path",{key:t,style:{fill:(0,r.getColor)(t),stroke:(0,r.getColor)(t)},d:"M 70 70 L 70 0 L 65 10 L 75 10 L 70 0",transform:`rotate(${e.datapoints[P][1]} 70 70)`}))))))))))},Output:e=>{const{WarningSignal:t,ReactivePower:a,RealPower:n,QAreaValue:i}=r.AdapterHelperFuncs.parseConnectionString(e.ConnectionString),s=[t,a,n,i].filter((e=>null!=e&&""!==e)).join("; ");return l.createElement(r.DefaultAdapterOutput,Object.assign({},e,{Outputs:s}))}}}}]);