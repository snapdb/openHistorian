"use strict";(self.webpackChunk=self.webpackChunk||[]).push([[642],{73642:(e,t,a)=>{a.r(t),a.d(t,{default:()=>v});var n=a(6904),l=a(2580),r=a(54840),s=a(24334);const u={TrackRecentValues:{Value:!1,Description:"Flag that determines if the last few values should be monitored."},SampleSize:{Value:5,Description:"Defines the sample size of the data to be monitored."},BadDataStrategy:{Value:"FlagAsBad",Description:"Defines bad data strategy used to when inputs are marked with bad quality."},InputMeasurementKeys:{Value:[],Description:"Defines primary keys of input measurements the action adapter expects; can be one of a filter expression, measurement key, point tag or Guid.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")},OutputMeasurements:{Value:[],Description:"Defines primary keys of output measurements the action adapter expects; can be one of a filter expression, measurement key, point tag or Guid.",Parse:e=>null==e?[]:""===e?[""]:e.split(";"),Construct:e=>0===(null==e?void 0:e.length)?null:null==e?void 0:e.join(";")},IncludePositiveSequence:{Value:!0,Description:"Defines flag that determines if adapter should produce positive sequence result (phasor)."},IncludeNegativeSequence:{Value:!0,Description:"Defines flag that determines if adapter should produce negative sequence result (phasor)."},IncludeZeroSequence:{Value:!0,Description:"Defines flag that determines if adapter should produce zero sequence result (phasor)."},LagTime:{Value:3,IsValid:e=>e>0,Description:"Defines the allowed past time deviation tolerance, in seconds (can be sub-second)."},LeadTime:{Value:1,IsValid:e=>e>0,Description:"Defines the allowed future time deviation tolerance, in seconds (can be sub-second)."},FramesPerSecond:{Value:30,Description:"Defines the number of frames per second expected by the adapter.",IsValid:e=>e>0}},i=(e,t,a)=>t.Search({dataTypeIndex:r.Grafana.DataTypeIndex.Phasor,expression:`SELECT ${a?"AnglePointTag":"MagnitudePointTag"} FROM PhasorValues WHERE PointTag LIKE '%${e}%'`}).then((e=>e.map((e=>({Label:`${e}`,Value:`${e.trim()}`})))));var c=a(32098),o=a.n(c),d=a(55476),m=a(28188),p=a(94194);const S="MM/DD/YYYY HH:mm:ss.SSS",g=e=>[{refID:"A",target:e.join("; "),metadataSelections:[]}],v={Settings:e=>{var t,a,c,o,d,m,p,S,g,v,h,f,y,I,E,b,M,w;const N=`${e.HomePath}api/Grafana`,D=new r.GrafanaQueryFunctions(N),L=n.useRef(null),{clientWidth:O}=(0,s.useGetContainerPosition)(L),T=n.useMemo((()=>r.AdapterHelperFuncs.parseConnectionString(e.ConnectionString,u)),[e.ConnectionString]);r.AdapterHelperFuncs.useSetInitialConnectionString(e.ConnectionString,e.SetConnectionString,u,T),r.AdapterHelperFuncs.useSetDefaultSettings(u,e.SetDefaultSettings);const F=n.useCallback((t=>{return a=void 0,n=void 0,s=function*(){const a=Object.assign({},t),n=r.AdapterHelperFuncs.constructConnectionString(a,u);n!==e.ConnectionString&&e.SetConnectionString(n)},new((l=void 0)||(l=Promise))((function(e,t){function r(e){try{i(s.next(e))}catch(e){t(e)}}function u(e){try{i(s.throw(e))}catch(e){t(e)}}function i(t){var a;t.done?e(t.value):(a=t.value,a instanceof l?a:new l((function(e){e(a)}))).then(r,u)}i((s=s.apply(a,n||[])).next())}));var a,n,l,s}),[e.ConnectionString]),x=n.useCallback(((e,t)=>{var a;const n=[...null!==(a=T.InputMeasurementKeys)&&void 0!==a?a:[]];n[t]=e,F(Object.assign(Object.assign({},T),{InputMeasurementKeys:n}))}),[T,F]),C=n.useCallback(((e,t)=>{var a;const n=[...null!==(a=T.OutputMeasurements)&&void 0!==a?a:[]];n[t]=e,F(Object.assign(Object.assign({},T),{OutputMeasurements:n}))}),[T,F]);n.useEffect((()=>{var t,a;const n=[];if(null==T)return;(null==T.SampleSize||T.SampleSize<=0)&&n.push("Sequence Calculator sample size must be greater than zero and non-empty."),(null==T.LagTime||T.LagTime<=0)&&n.push("Lag Time must be greater than 0."),(null==T.LeadTime||T.LeadTime<=0)&&n.push("Lead Time must be greater than 0."),(null==T.FramesPerSecond||T.FramesPerSecond<=0)&&n.push("Frames Per Second must be greater than 0."),(null==T.InputMeasurementKeys||T.InputMeasurementKeys.length<2)&&n.push("At least two input measurements are required.");const l=(T.IncludePositiveSequence?2:0)+(T.IncludeNegativeSequence?2:0)+(T.IncludeZeroSequence?2:0),r=null!==(a=null===(t=T.OutputMeasurements)||void 0===t?void 0:t.length)&&void 0!==a?a:0;r!==l&&n.push(`Expected ${r} output measurement(s) based on enabled sequences, but got ${r}.`),e.SetErrors(n)}),[T,e.SetErrors]),n.useEffect((()=>{var e,t,a,n,l,r,s;const u=null!==(e=T.OutputMeasurements)&&void 0!==e?e:[],i=[];let c=0;T.IncludePositiveSequence?i.push(null!==(t=u[c++])&&void 0!==t?t:"",null!==(a=u[c++])&&void 0!==a?a:""):c+=2,T.IncludeNegativeSequence?i.push(null!==(n=u[c++])&&void 0!==n?n:"",null!==(l=u[c++])&&void 0!==l?l:""):c+=2,T.IncludeZeroSequence&&i.push(null!==(r=u[c++])&&void 0!==r?r:"",null!==(s=u[c++])&&void 0!==s?s:""),(i.length!==u.length||i.some(((e,t)=>e!==u[t])))&&F(Object.assign(Object.assign({},T),{OutputMeasurements:i}))}),[T.IncludePositiveSequence,T.IncludeNegativeSequence,T.IncludeZeroSequence]);const q=T.IncludePositiveSequence?2:0,A=q+(T.IncludeNegativeSequence?2:0);return n.createElement(n.Fragment,null,null!=T?n.createElement("div",{className:"container-fluid d-flex flex-column h-100 p-0"},n.createElement("div",{className:"row mb-3"},n.createElement("div",{className:"col-12"},n.createElement("fieldset",{className:"border",style:{padding:"10px"}},n.createElement("legend",{className:"w-auto pr-2",style:{fontSize:"large"}},"Line Phasor"),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement("label",null,"Measurements"))),n.createElement("div",{className:"row align-items-center mb-3"},n.createElement("div",{className:"col-auto"},"A"),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(a=null===(t=T.InputMeasurementKeys)||void 0===t?void 0:t[0])&&void 0!==a?a:""},Field:"InputMeasurement",Label:"Magnitude",Setter:e=>x(e.InputMeasurement,0),AllowCustom:!1,Search:e=>i(e,D,!1),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(o=null===(c=T.InputMeasurementKeys)||void 0===c?void 0:c[1])&&void 0!==o?o:""},Field:"InputMeasurement",Label:"Angle",Setter:e=>x(e.InputMeasurement,1),AllowCustom:!1,Search:e=>i(e,D,!0),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:0===T.InputMeasurementKeys.length}))),n.createElement("div",{className:"row align-items-center mb-3"},n.createElement("div",{className:"col-auto"},"B"),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(m=null===(d=T.InputMeasurementKeys)||void 0===d?void 0:d[2])&&void 0!==m?m:""},Field:"InputMeasurement",Label:"Magnitude",Setter:e=>x(e.InputMeasurement,2),AllowCustom:!1,Search:e=>i(e,D,!1),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:T.InputMeasurementKeys.length<2})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(S=null===(p=T.InputMeasurementKeys)||void 0===p?void 0:p[3])&&void 0!==S?S:""},Field:"InputMeasurement",Label:"Angle",Setter:e=>x(e.InputMeasurement,3),AllowCustom:!1,Search:e=>i(e,D,!0),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:T.InputMeasurementKeys.length<3}))),n.createElement("div",{className:"row align-items-center"},n.createElement("div",{className:"col-auto"},"C"),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(v=null===(g=T.InputMeasurementKeys)||void 0===g?void 0:g[4])&&void 0!==v?v:""},Field:"InputMeasurement",Label:"Magnitude",Setter:e=>x(e.InputMeasurement,4),AllowCustom:!1,Search:e=>i(e,D,!1),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:T.InputMeasurementKeys.length<4})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{InputMeasurement:null!==(f=null===(h=T.InputMeasurementKeys)||void 0===h?void 0:h[5])&&void 0!==f?f:""},Field:"InputMeasurement",Label:"Angle",Setter:e=>x(e.InputMeasurement,5),AllowCustom:!1,Search:e=>i(e,D,!0),Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"},Disabled:T.InputMeasurementKeys.length<5})))))),n.createElement("div",{className:"row mb-3"},n.createElement("div",{className:"col-12"},n.createElement("fieldset",{className:"border",style:{padding:"10px"}},n.createElement("legend",{className:"w-auto pr-2",style:{fontSize:"large"}},"Outputs"),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-auto",style:{width:O}},n.createElement(l.ToggleSwitch,{Record:T,Field:"IncludePositiveSequence",Label:"Include Positive Sequence Output",Setter:F,Help:u.IncludePositiveSequence.Description})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludePositiveSequence&&null!==(y=T.OutputMeasurements[0])&&void 0!==y?y:""},Field:"OutputMeasurement",Label:"Magnitude",Setter:e=>C(e.OutputMeasurement,0),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludePositiveSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludePositiveSequence&&null!==(I=T.OutputMeasurements[1])&&void 0!==I?I:""},Field:"OutputMeasurement",Label:"Angle",Setter:e=>C(e.OutputMeasurement,1),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludePositiveSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-auto",ref:L},n.createElement(l.ToggleSwitch,{Record:T,Field:"IncludeNegativeSequence",Label:"Include Negative Sequence Output",Setter:F,Help:u.IncludeNegativeSequence.Description})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludeNegativeSequence&&null!==(E=T.OutputMeasurements[q])&&void 0!==E?E:""},Field:"OutputMeasurement",Label:"Magnitude",Setter:e=>C(e.OutputMeasurement,q),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludeNegativeSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludeNegativeSequence&&null!==(b=T.OutputMeasurements[q+1])&&void 0!==b?b:""},Field:"OutputMeasurement",Label:"Angle",Setter:e=>C(e.OutputMeasurement,q+1),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludeNegativeSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-auto",style:{width:O}},n.createElement(l.ToggleSwitch,{Record:T,Field:"IncludeZeroSequence",Label:"Include Zero Sequence Output",Setter:F,Help:u.IncludeZeroSequence.Description})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludeZeroSequence&&null!==(M=T.OutputMeasurements[A])&&void 0!==M?M:""},Field:"OutputMeasurement",Label:"Magnitude",Setter:e=>C(e.OutputMeasurement,A),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludeZeroSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})),n.createElement("div",{className:"col"},n.createElement(l.SearchableSelect,{Record:{OutputMeasurement:T.IncludeZeroSequence&&null!==(w=T.OutputMeasurements[A+1])&&void 0!==w?w:""},Field:"OutputMeasurement",Label:"Angle",Setter:e=>C(e.OutputMeasurement,A+1),AllowCustom:!1,Search:e=>(0,r.handleMeasurementSearch)(e,N),Disabled:!T.IncludeZeroSequence,Style:{width:"100%"},BtnStyle:{display:"flex",paddingLeft:0,alignItems:"center"}})))))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement(l.Input,{Record:T,Type:"number",AllowNull:!1,Field:"SampleSize",Label:"Sample Size",Valid:e=>!0,Setter:F,Help:u.SampleSize.Description,Feedback:"Sequence Calculator sample size must be greater than zero and non-empty."}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement(l.Select,{Record:T,Field:"BadDataStrategy",Label:"Bad Data Strategy",Setter:F,Help:u.BadDataStrategy.Description,Options:r.AdapterOptions.BadDataStrategyOptions}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12 col-xl-4"},n.createElement(l.Input,{Record:T,Setter:F,Label:"Frames Per Second",Type:"number",Field:"FramesPerSecond",Valid:e=>{var t,a,n;return null===(n=null===(a=null===(t=null==u?void 0:u.FramesPerSecond)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,T[e]))||void 0===n||n},Feedback:"Frames Per Second must be greater than 0.",Help:u.FramesPerSecond.Description,AllowNull:!0})),n.createElement("div",{className:"col-12 col-xl-4"},n.createElement(l.Input,{Record:T,Setter:F,Label:"Lag Time",Type:"number",Field:"LagTime",Valid:e=>{var t,a,n;return null===(n=null===(a=null===(t=u.LagTime)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,T[e]))||void 0===n||n},Feedback:"Lag Time must be greater than 0.",Help:u.LagTime.Description,AllowNull:!0})),n.createElement("div",{className:"col-12 col-xl-4"},n.createElement(l.Input,{Record:T,Setter:F,Label:"Lead Time",Type:"number",Field:"LeadTime",Valid:e=>{var t,a,n;return null===(n=null===(a=null===(t=u.LeadTime)||void 0===t?void 0:t.IsValid)||void 0===a?void 0:a.call(t,T[e]))||void 0===n||n},Feedback:"Lead Time must be greater than 0.",Help:u.LeadTime.Description,AllowNull:!0}))),n.createElement("div",{className:"row"},n.createElement("div",{className:"col-12"},n.createElement(l.ToggleSwitch,{Record:T,Field:"TrackRecentValues",Label:"Track Recent Values",Setter:F,Help:u.TrackRecentValues.Description})))):null)},Input:e=>{var t,a,l,i;const c=`${e.HomePath}api/grafana`,v=n.useMemo((()=>r.AdapterHelperFuncs.parseConnectionString(e.ConnectionString,u)),[e.ConnectionString]),h=n.useRef(null),{width:f}=(0,s.useGetContainerPosition)(h),y=(0,r.useGetLegendWidth)(f),[I,E]=n.useState([]),[b,M]=n.useState([]),[w,N]=n.useState({start:o().utc().subtract(null!==(a=null===(t=e.Settings)||void 0===t?void 0:t.DefaultDuration)&&void 0!==a?a:30,"seconds").format(S).toString(),end:o().utc().format(S).toString()}),D=n.useMemo((()=>g(b)),[b]),L=n.useMemo((()=>g(I)),[I]),{Data:O,Status:T}=(0,r.useGrafanaQuery)(D,o().utc(w.start).toISOString(),o().utc(w.end).toISOString(),c,r.Grafana.DataTypeIndex.Measurement),{Data:F,Status:x}=(0,r.useGrafanaQuery)(L,o().utc(w.start).toISOString(),o().utc(w.end).toISOString(),c,r.Grafana.DataTypeIndex.Measurement);return n.useEffect((()=>{if(null==v.InputMeasurementKeys)return;const{MagTags:e,AngTags:t}=(e=>{const t=[],a=[];return e.forEach(((e,n)=>{n%2==0?t.push(e):a.push(e)})),{MagTags:t,AngTags:a}})(v.InputMeasurementKeys);E(e),M(t)}),[v.InputMeasurementKeys]),n.createElement(n.Fragment,null,n.createElement("div",{className:"container-fluid d-flex flex-column h-100 p-0"},n.createElement("div",{className:"row m-0 pb-3"},n.createElement("div",{className:"col-12 p-0"},n.createElement(d.TimeFilter,{filter:w,setFilter:(e,t)=>N({start:e,end:t}),showQuickSelect:!0,isHorizontal:!0,dateTimeSetting:null!==(i=null===(l=e.Settings)||void 0===l?void 0:l.DateTimeSetting)&&void 0!==i?i:"startEnd",timeZone:"UTC",accuracy:"millisecond",format:"datetime-local",showHelpMessage:!1}))),"loading"===T||"loading"===x?n.createElement("div",{className:"row m-0"},n.createElement("div",{className:"col-12 p-0 d-flex flex-column align-items-center justify-content-center"},n.createElement(p.ReactIcons.SpiningIcon,{Size:200}))):n.createElement("div",{className:"row m-0"},n.createElement("div",{className:"col-9 p-0",ref:h},n.createElement(m.Kl,{defaultTdomain:[o().utc(w.start,S).valueOf(),o().utc(w.end,S).valueOf()],height:250,width:f,legend:"right",yDomain:"AutoValue",Tlabel:"Time",Ylabel:"Angle",useMetricFactors:!1,legendWidth:y,showDateOnTimeAxis:!0},O.map(((e,t)=>n.createElement(m.N1,{key:t,data:e.datapoints.map((e=>[e[1],e[0]])),color:(0,r.getColor)(t),lineStyle:"-",legend:e.target})))),n.createElement(m.Kl,{defaultTdomain:[o().utc(w.start,S).valueOf(),o().utc(w.end,S).valueOf()],height:250,width:f,legend:"right",yDomain:"AutoValue",Tlabel:"Time",Ylabel:"Magnitude",useMetricFactors:!1,legendWidth:y,showDateOnTimeAxis:!0},F.map(((e,t)=>n.createElement(m.N1,{key:t,data:e.datapoints.map((e=>[e[1],e[0]])),color:(0,r.getColor)(t),lineStyle:"-",legend:e.target}))))),n.createElement("div",{className:"col-3 p-0 d-flex justify-content-center align-items-center"},n.createElement("svg",{width:"140",height:"140",viewBox:"0 0 140 140",style:{display:"block",marginTop:"8px"}},n.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:65}),n.createElement("circle",{style:{fill:"none",stroke:"currentColor"},cx:70,cy:70,r:35}),n.createElement("line",{style:{stroke:"currentColor"},x1:70,y1:0,x2:70,y2:140}),n.createElement("line",{style:{stroke:"currentColor"},x1:0,y1:70,x2:140,y2:70}),n.createElement("g",null,O.map(((e,t)=>0!==e.datapoints.length&&n.createElement("path",{key:t,style:{fill:(0,r.getColor)(t),stroke:(0,r.getColor)(t)},d:"M 70 70 L 70 0 L 65 10 L 75 10 L 70 0",transform:`rotate(${e.datapoints[0][0]} 70 70)`})))))))))},Output:null}}}]);